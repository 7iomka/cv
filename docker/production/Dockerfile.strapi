FROM node:20-alpine

WORKDIR /strapi

RUN npm install pm2 -g

COPY package*.json ./

RUN npm ci --omit=dev

COPY . ./

RUN npm run build

EXPOSE 1337

CMD [ "pm2-runtime", "npm", "--", "start"]